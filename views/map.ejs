<%-include header%>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script>
    console.log('inside script tag');
    var map;

    function initialize() {
        console.log('in initialize.');

        var mapOptions = {
            zoom: 12,
            center: new google.maps.LatLng(49.246292, -123.116226)
        };
        map = new google.maps.Map(document.getElementById('map-canvas'),
                mapOptions);

        <%for(var i in crimes){%>
            var latLng = new google.maps.LatLng(<%=crimes[i].lat%>, <%=crimes[i].long%>);
            var marker = new google.maps.Marker({
            position: latLng,
            map: map,
            title:"Hello World!"
            });
            <%}%>

        var ctaLayer = new google.maps.KmlLayer({
            url: 'http://data.vancouver.ca/download/kml/cov_localareas.kml'
        });
        ctaLayer.setMap(map);
    }


    //initialize();
    console.log("in map.js");
    google.maps.event.addDomListener(window, 'load', initialize);
</script>


<div id="map-canvas"></div>
<%-include footer%>
